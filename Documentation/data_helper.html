

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>data_helper &mdash; V2G-QUESTS March 2024 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=9493f942"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="helper_functions" href="helper_functions.html" />
    <link rel="prev" title="V2G" href="V2G.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            V2G-QUESTS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">V2G_Wrap_Up</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="SystemData.html">SystemData</a></li>
<li class="toctree-l2"><a class="reference internal" href="V2G.html">V2G</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">data_helper</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#key-features">Key Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.detect_branching_levels"><code class="docutils literal notranslate"><span class="pre">detect_branching_levels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.model_to_sqlite"><code class="docutils literal notranslate"><span class="pre">model_to_sqlite()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.extract_table_to_dataframe"><code class="docutils literal notranslate"><span class="pre">extract_table_to_dataframe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.safe_slice"><code class="docutils literal notranslate"><span class="pre">safe_slice()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.build_demand_timeseries"><code class="docutils literal notranslate"><span class="pre">build_demand_timeseries()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.plot_input_only"><code class="docutils literal notranslate"><span class="pre">plot_input_only()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.load_capacity_data"><code class="docutils literal notranslate"><span class="pre">load_capacity_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.load_price_data"><code class="docutils literal notranslate"><span class="pre">load_price_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.create_availability_matrix"><code class="docutils literal notranslate"><span class="pre">create_availability_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.load_ev_data"><code class="docutils literal notranslate"><span class="pre">load_ev_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.load_ev_battery_data"><code class="docutils literal notranslate"><span class="pre">load_ev_battery_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.load_generator_data"><code class="docutils literal notranslate"><span class="pre">load_generator_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.load_bus_branch_demand_data"><code class="docutils literal notranslate"><span class="pre">load_bus_branch_demand_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.distribute_storage_capacity"><code class="docutils literal notranslate"><span class="pre">distribute_storage_capacity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#data_helper.load_distributed_battery_data"><code class="docutils literal notranslate"><span class="pre">load_distributed_battery_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="helper_functions.html">helper_functions</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">V2G-QUESTS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">V2G_Wrap_Up</a></li>
      <li class="breadcrumb-item active">data_helper</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/data_helper.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-data_helper">
<span id="data-helper"></span><h1>data_helper<a class="headerlink" href="#module-data_helper" title="Link to this heading"></a></h1>
<p>This module contains helper functions to read, process, and manipulate data for various test cases and simulations.
It includes utilities for graph analysis, behavior profile generation, data extraction, demand time series creation,
and visualization. The functions are designed to work with power grid data, electric vehicle behavior profiles,
and Pyomo models, among other use cases.</p>
<section id="key-features">
<h2>Key Features<a class="headerlink" href="#key-features" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Graph analysis for detecting branching levels in network structures.</p></li>
<li><p>SQLite database integration for saving and extracting Pyomo model data.</p></li>
<li><p>Demand time series generation for specific case studies.</p></li>
<li><p>Visualization of power grid networks using Plotly.</p></li>
<li><p>Loading and processing of bus, branch, and demand data for simulations.</p></li>
</ul>
<p>Usage:
This module is designed to be imported and used as a utility toolkit in the V2G-QUESTS project.</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="data_helper.detect_branching_levels">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">detect_branching_levels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Branches</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#detect_branching_levels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.detect_branching_levels" title="Link to this definition"></a></dt>
<dd><p>Analyze a graph structure to determine node levels, branching points,
branch counts before each node, and counts of further nodes in each subtree.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Branches</strong> (<em>list</em><em> of </em><em>dict</em>) – Each dictionary represents an edge of the graph and should contain:
- ‘fbus’: From bus ID
- ‘tbus’: To bus ID</p></li>
<li><p><strong>root</strong> (<em>int</em><em>, </em><em>optional</em>) – The root node of the graph. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>tuple</em> –</p>
<ul class="simple">
<li><p>levels (dict): Maps each node to its level (distance from the root)</p></li>
<li><p>branch_points (list): Nodes that are branching points (more than one child)</p></li>
<li><p>branch_count_before (dict): Count of branch points before each node</p></li>
<li><p>further_nodes_count (dict): Count of nodes in each node’s subtree (excluding itself)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.model_to_sqlite">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">model_to_sqlite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#model_to_sqlite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.model_to_sqlite" title="Link to this definition"></a></dt>
<dd><p>Save components of a Pyomo model to an SQLite database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>pyo.base.Model</em>) – The Pyomo model containing components to save.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Path to the SQLite database file. Creates the directory if it does not exist.</p></li>
<li><p><strong>Behavior</strong></p></li>
<li><p><strong>--------</strong></p></li>
<li><p><strong>OrderedScalarSet</strong> (<em>-</em>)</p></li>
<li><p><strong>IndexedVar</strong> (<em>-</em>)</p></li>
<li><p><strong>IndexedParam</strong> (<em>Extracts values and saves with indices.</em>)</p></li>
<li><p><strong>ScalarParam</strong> (<em>Extracts values and saves with indices.</em>)</p></li>
<li><p><strong>ScalarObjective</strong> (<em>-</em>)</p></li>
<li><p><strong>ConstraintList</strong> (<em>-</em>)</p></li>
<li><p><strong>types</strong> (<em>- Unsupported component</em>)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses component names as table names in SQLite.</p></li>
<li><p>Replaces existing tables with the same name.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – Propagates any exceptions related to SQLite or Pyomo processing.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">import</span> <span class="pre">pyomo.environ</span> <span class="pre">as</span> <span class="pre">pyo</span>
<span class="pre">model</span> <span class="pre">=</span> <span class="pre">pyo.ConcreteModel()</span>
<span class="pre">model.x</span> <span class="pre">=</span> <span class="pre">pyo.Var([1,</span> <span class="pre">2,</span> <span class="pre">3],</span> <span class="pre">initialize=0)</span>
<span class="pre">model_to_sqlite(model,</span> <span class="pre">&quot;output/model_data.sqlite&quot;)</span>
<span class="pre">`</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.extract_table_to_dataframe">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">extract_table_to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">con</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#extract_table_to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.extract_table_to_dataframe" title="Link to this definition"></a></dt>
<dd><p>Extract the contents of a database table into a pandas DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>con</strong> (<em>sqlite3.Connection</em>) – Database connection object.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – Name of the table to extract.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pandas.DataFrame or None</em> – DataFrame with the table’s data if successful; None if an error occurs.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – Prints an error message if table extraction fails.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.safe_slice">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">safe_slice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_t</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#safe_slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.safe_slice" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.build_demand_timeseries">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">build_demand_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#build_demand_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.build_demand_timeseries" title="Link to this definition"></a></dt>
<dd><p>Construct node-level demand time series for a given case study.</p>
<p>Supports three case studies: ‘Kanaleneiland’, ‘Aradas’, ‘Annelinn’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_study</strong> (<em>str</em>) – Case study name:
- ‘Kanaleneiland’: Uses node-specific yearly totals and normalized templates.
- ‘Aradas’: Interpolates monthly profiles with typical daily shapes.
- ‘Annelinn’: Uses a single base profile with random noise.</p></li>
<li><p><strong>num_t</strong> (<em>int</em>) – Number of time steps (hours) to generate.</p></li>
<li><p><strong>start_t</strong> (<em>int</em>) – Starting time step (hour offset).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pd.DataFrame</em> – Shape (num_t, num_nodes), each column is a node’s hourly demand.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If an unsupported case study is provided.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>‘Kanaleneiland’: Each node scales a normalized template by annual demand.</p></li>
<li><p>‘Aradas’: Monthly-resolution demand scaled to match annual totals.</p></li>
<li><p>‘Annelinn’: Base profile replicated across nodes with Gaussian noise.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.plot_input_only">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">plot_input_only</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buses_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">branches_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#plot_input_only"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.plot_input_only" title="Link to this definition"></a></dt>
<dd><p>Plot a geographical visualization of buses and branches on a map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buses_df</strong> (<em>pd.DataFrame</em>) – Bus information with columns:
- ‘id’: Bus ID
- ‘lat’: Latitude
- ‘lon’: Longitude</p></li>
<li><p><strong>branches_df</strong> (<em>pd.DataFrame</em>) – Branch information with columns:
- ‘fbus’: From bus ID
- ‘tbus’: To bus ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>None</em></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Uses Plotly to display a Mercator-projected map scoped to Europe.</p></li>
<li><p>Dynamically adjusts geographical range based on bus lat/lon.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.load_capacity_data">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">load_capacity_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_pv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_wind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_hydro</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#load_capacity_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.load_capacity_data" title="Link to this definition"></a></dt>
<dd><p>Load PV, wind, and hydro capacity data for a given case study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_study</strong> (<em>str</em>) – Case study name (‘Kanaleneiland’, ‘Aradas’, or ‘Annelinn’).</p></li>
<li><p><strong>num_t</strong> (<em>int</em>) – Number of time steps to load.</p></li>
<li><p><strong>start_t</strong> (<em>int</em>) – Starting time index.</p></li>
<li><p><strong>enable_pv</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enable PV generation. Defaults to True.</p></li>
<li><p><strong>enable_wind</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enable wind generation. Defaults to True.</p></li>
<li><p><strong>enable_hydro</strong> (<em>bool</em><em>, </em><em>optional</em>) – Enable hydro generation. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>tuple of pandas.DataFrame</em> – (pv_df, wind_df, hydro_df) with capacity time series in column ‘electricity’.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the case study is not recognized.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Data is loaded from <cite>data_preparation/&lt;case_study&gt;/final_data/</cite>.</p></li>
<li><p>PV and wind files skip 3 header rows; hydro does not.</p></li>
<li><p>Only the ‘electricity’ column is used.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.load_price_data">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">load_price_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#load_price_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.load_price_data" title="Link to this definition"></a></dt>
<dd><p>Load electricity price time series for a given case study and year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_study</strong> (<em>str</em>) – ‘Kanaleneiland’, ‘Aradas’, or ‘Annelinn’.</p></li>
<li><p><strong>num_t</strong> (<em>int</em>) – Number of time steps to load.</p></li>
<li><p><strong>start_t</strong> (<em>int</em>) – Starting time index.</p></li>
<li><p><strong>year</strong> (<em>int</em>) – Year of the price data (e.g., 2035, 2040, 2050).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pandas.DataFrame</em> – Price time series for the selected case study and year.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the case study or year is not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.create_availability_matrix">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">create_availability_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Buses</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#create_availability_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.create_availability_matrix" title="Link to this definition"></a></dt>
<dd><p>Create a 3D availability matrix of EVs across nodes and time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evs</strong> (<em>pandas.DataFrame</em>) – EV data with columns [‘vehicle_name’, ‘node’, ‘arrival_time [h]’, ‘departure_time [h]’].</p></li>
<li><p><strong>Buses</strong> (<em>pandas.DataFrame</em>) – Bus data with column ‘id’ representing node identifiers.</p></li>
<li><p><strong>num_t</strong> (<em>int</em>) – Number of time steps in the simulation horizon.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><em>tuple</em> –</p>
<ul class="simple">
<li><p>vehicles : list of EV names</p></li>
<li><p>availability_matrix : numpy array of shape (n_vehicles, n_nodes, num_t),
1 indicates EV presence at a node, 0 otherwise.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If the time horizon exceeds the available EV data, the pattern may be repeated.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.load_ev_data">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">load_ev_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#load_ev_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.load_ev_data" title="Link to this definition"></a></dt>
<dd><p>Load aggregated electric vehicle (EV) data for a given case study.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>case_study</strong> (<em>str</em>) – Name of the case study (‘Kanaleneiland’, ‘Aradas’, ‘Annelinn’).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pandas.DataFrame</em> – DataFrame containing EV trip and availability data from the
‘adjusted_intervals_hrs’ sheet.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the case study name is not recognized.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.load_ev_battery_data">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">load_ev_battery_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#load_ev_battery_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.load_ev_battery_data" title="Link to this definition"></a></dt>
<dd><p>Load electric vehicle (EV) battery parameters for each archetype.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>pandas.DataFrame</em> – DataFrame containing EV battery parameters, including:
- Charge efficiency
- Discharge efficiency
- Initial state of charge (SOC)
- Battery capacity
- Maximum charging power
- Maximum discharging power</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.load_generator_data">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">load_generator_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#load_generator_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.load_generator_data" title="Link to this definition"></a></dt>
<dd><p>Load generator data for a given case study and scenario year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_study</strong> (<em>str</em>) – Name of the case study (‘Kanaleneiland’, ‘Aradas’, or ‘Annelinn’).</p></li>
<li><p><strong>year</strong> (<em>int</em>) – Scenario year (e.g., 2035, 2040, 2050).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pandas.DataFrame</em> – Cleaned generator dataset containing capacity and operational parameters.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the case study or year is not supported.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.load_bus_branch_demand_data">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">load_bus_branch_demand_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_study</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slack_bus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#load_bus_branch_demand_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.load_bus_branch_demand_data" title="Link to this definition"></a></dt>
<dd><p>Load, preprocess, and combine network topology and demand data.</p>
<p>This function loads node, line, and demand data for the specified case study,
assigns electrical parameters to buses, computes line impedances, admittances,
and limits, and identifies branches connected to the slack bus.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_study</strong> (<em>str</em>) – Name of the case study (‘Kanaleneiland’, ‘Aradas’, or ‘Annelinn’).</p></li>
<li><p><strong>num_t</strong> (<em>int</em>) – Number of time steps to extract from the demand time series.</p></li>
<li><p><strong>start_t</strong> (<em>int</em>) – Starting index for the time series slice.</p></li>
<li><p><strong>slack_bus</strong> (<em>str</em>) – ID or name of the slack/reference bus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul>
<li><p><em>tuple of pandas.DataFrame</em> –</p>
<dl class="simple">
<dt>(</dt><dd><p>Buses_df,      # Bus-level electrical and geographic data
Branches_df,   # Line parameters (admittance, limits, angle bounds)
demand_p_df,   # Active power demand time series
demand_q_df,   # Reactive power demand time series
node_data      # Raw node metadata (coordinates, IDs)</p>
</dd>
</dl>
<p>)</p>
</li>
<li><p><em>Processing Steps</em></p></li>
<li><p><em>—————-</em></p></li>
<li><p><em>1. Load standard line parameters and case-specific node/line data.</em></p></li>
<li><p><em>2. Assign geographic coordinates (lat/lon) to each node.</em></p></li>
<li><ol class="arabic simple" start="3">
<li><p>Build <cite>Buses_df</cite> with voltage and angle limits (radians).</p></li>
</ol>
</li>
<li><p><em>4. Construct time-dependent demand data; missing nodes receive zero demand.</em></p></li>
<li><p><em>5. Identify branches connected to the slack bus.</em></p></li>
<li><p><em>6. Compute line impedance, admittance, and capacity values.</em></p></li>
<li><p><em>7. Return fully processed DataFrames for model integration.</em></p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the case study is not recognized or required columns are missing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.distribute_storage_capacity">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">distribute_storage_capacity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">case_study</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pBatt_cap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slack_bus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_capacity_nodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#distribute_storage_capacity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.distribute_storage_capacity" title="Link to this definition"></a></dt>
<dd><p>Randomly distribute total storage capacity among network nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>case_study</strong> (<em>str</em>) – Name of the case study (‘Kanaleneiland’, ‘Aradas’, or ‘Annelinn’).</p></li>
<li><p><strong>pBatt_cap</strong> (<em>float</em>) – Total storage capacity to distribute (MW).</p></li>
<li><p><strong>node_ids</strong> (<em>list</em>) – List of node identifiers.</p></li>
<li><p><strong>zero_capacity_nodes</strong> (<em>list</em><em>, </em><em>optional</em>) – Nodes to exclude from allocation. Defaults to None.
Slack bus is automatically excluded. Example: [slack_bus, ‘Node_67’]</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pandas.DataFrame</em> – DataFrame mapping each node to its assigned storage capacity.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="data_helper.load_distributed_battery_data">
<span class="sig-prename descclassname"><span class="pre">data_helper.</span></span><span class="sig-name descname"><span class="pre">load_distributed_battery_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/data_helper.html#load_distributed_battery_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#data_helper.load_distributed_battery_data" title="Link to this definition"></a></dt>
<dd><p>Load standard distributed battery parameters from configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>pandas.DataFrame</em> – Single-row DataFrame containing:
- Battery efficiency
- Depth of discharge
- C-rate
- Initial state of charge</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="V2G.html" class="btn btn-neutral float-left" title="V2G" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="helper_functions.html" class="btn btn-neutral float-right" title="helper_functions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kelvin Walenta.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>